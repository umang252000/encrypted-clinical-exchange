{"ast":null,"code":"import React,{useState,useEffect}from\"react\";// ----------------------------------\n// Helper: decode JWT payload (UI only)\n// ----------------------------------\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function parseJwtPayload(token){try{const base64Url=token.split(\".\")[1];if(!base64Url)return null;const base64=base64Url.replace(/-/g,\"+\").replace(/_/g,\"/\");const jsonPayload=decodeURIComponent(atob(base64).split(\"\").map(c=>\"%\"+(\"00\"+c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));return JSON.parse(jsonPayload);}catch(_unused){return null;}}export default function Login(_ref){let{onToken}=_ref;const[token,setToken]=useState(\"\");const[decoded,setDecoded]=useState(null);const[message,setMessage]=useState(\"\");// ----------------------------------\n// Load saved token on mount\n// ----------------------------------\nuseEffect(()=>{const saved=sessionStorage.getItem(\"jwt\");if(saved){setToken(saved);setDecoded(parseJwtPayload(saved));}},[]);// ----------------------------------\n// Decode JWT live\n// ----------------------------------\nuseEffect(()=>{setDecoded(parseJwtPayload(token));},[token]);// ----------------------------------\n// Validation\n// ----------------------------------\nconst isExpired=(decoded===null||decoded===void 0?void 0:decoded.exp)&&decoded.exp*1000<Date.now();const isValid=decoded&&decoded.sub&&decoded.role&&!isExpired;// ----------------------------------\n// Actions\n// ----------------------------------\nfunction handleLogin(){if(!isValid){setMessage(\"‚ùå Invalid or expired token\");onToken(\"\");return;}onToken(token);setMessage(\"‚úÖ Logged in successfully\");}function handleClear(){setToken(\"\");setDecoded(null);onToken(\"\");sessionStorage.removeItem(\"jwt\");setMessage(\"üîÑ Token cleared\");}// ----------------------------------\n// UI\n// ----------------------------------\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:520,padding:20,borderRadius:10,border:\"1px solid #ddd\",background:\"#fff\",marginBottom:24},children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:12},children:\"\\uD83D\\uDD10 Clinician Login\"}),/*#__PURE__*/_jsx(\"input\",{style:{width:\"100%\",padding:\"10px 12px\",borderRadius:6,border:\"1px solid #ccc\",marginBottom:10},placeholder:\"Paste JWT token here\",value:token,onChange:e=>setToken(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,disabled:!token,style:{padding:\"8px 14px\",borderRadius:6,border:\"none\",background:\"#2563eb\",color:\"#fff\",cursor:\"pointer\"},children:\"Login\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClear,style:{padding:\"8px 14px\",borderRadius:6,border:\"1px solid #ccc\",background:\"#f5f5f5\",cursor:\"pointer\"},children:\"Clear\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10,color:isValid?\"green\":\"#d93025\"},children:message}),decoded&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:14,padding:10,background:\"#f9fafb\",borderRadius:6,fontSize:14},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Decoded Token\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"User: \",/*#__PURE__*/_jsx(\"b\",{children:decoded.sub})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Role: \",/*#__PURE__*/_jsx(\"b\",{children:decoded.role})]}),decoded.exp&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Expires:\",\" \",/*#__PURE__*/_jsx(\"b\",{style:{color:isExpired?\"#d93025\":\"green\"},children:new Date(decoded.exp*1000).toLocaleString()}),isExpired&&\" ‚ö†\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10,fontSize:12,color:\"#666\"},children:\"Token is stored locally and never sent anywhere except secured API calls.\"})]});}","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","parseJwtPayload","token","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","_unused","Login","_ref","onToken","setToken","decoded","setDecoded","message","setMessage","saved","sessionStorage","getItem","isExpired","exp","Date","now","isValid","sub","role","handleLogin","handleClear","removeItem","style","maxWidth","padding","borderRadius","border","background","marginBottom","children","width","placeholder","value","onChange","e","target","display","gap","onClick","disabled","color","cursor","marginTop","fontSize","toLocaleString"],"sources":["/workspaces/encrypted-clinical-exchange/clinician-ui/src/Login.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\n\n// ----------------------------------\n// Helper: decode JWT payload (UI only)\n// ----------------------------------\nfunction parseJwtPayload(token) {\n  try {\n    const base64Url = token.split(\".\")[1];\n    if (!base64Url) return null;\n    const base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const jsonPayload = decodeURIComponent(\n      atob(base64)\n        .split(\"\")\n        .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\n        .join(\"\")\n    );\n    return JSON.parse(jsonPayload);\n  } catch {\n    return null;\n  }\n}\n\nexport default function Login({ onToken }) {\n  const [token, setToken] = useState(\"\");\n  const [decoded, setDecoded] = useState(null);\n  const [message, setMessage] = useState(\"\");\n\n  // ----------------------------------\n  // Load saved token on mount\n  // ----------------------------------\n  useEffect(() => {\n    const saved = sessionStorage.getItem(\"jwt\");\n    if (saved) {\n      setToken(saved);\n      setDecoded(parseJwtPayload(saved));\n    }\n  }, []);\n\n  // ----------------------------------\n  // Decode JWT live\n  // ----------------------------------\n  useEffect(() => {\n    setDecoded(parseJwtPayload(token));\n  }, [token]);\n\n  // ----------------------------------\n  // Validation\n  // ----------------------------------\n  const isExpired =\n    decoded?.exp && decoded.exp * 1000 < Date.now();\n\n  const isValid =\n    decoded && decoded.sub && decoded.role && !isExpired;\n\n  // ----------------------------------\n  // Actions\n  // ----------------------------------\n  function handleLogin() {\n    if (!isValid) {\n      setMessage(\"‚ùå Invalid or expired token\");\n      onToken(\"\");\n      return;\n    }\n\n    onToken(token);\n    setMessage(\"‚úÖ Logged in successfully\");\n  }\n\n  function handleClear() {\n    setToken(\"\");\n    setDecoded(null);\n    onToken(\"\");\n    sessionStorage.removeItem(\"jwt\");\n    setMessage(\"üîÑ Token cleared\");\n  }\n\n  // ----------------------------------\n  // UI\n  // ----------------------------------\n  return (\n    <div\n      style={{\n        maxWidth: 520,\n        padding: 20,\n        borderRadius: 10,\n        border: \"1px solid #ddd\",\n        background: \"#fff\",\n        marginBottom: 24,\n      }}\n    >\n      <h3 style={{ marginBottom: 12 }}>\n        üîê Clinician Login\n      </h3>\n\n      <input\n        style={{\n          width: \"100%\",\n          padding: \"10px 12px\",\n          borderRadius: 6,\n          border: \"1px solid #ccc\",\n          marginBottom: 10,\n        }}\n        placeholder=\"Paste JWT token here\"\n        value={token}\n        onChange={(e) => setToken(e.target.value)}\n      />\n\n      <div style={{ display: \"flex\", gap: 8 }}>\n        <button\n          onClick={handleLogin}\n          disabled={!token}\n          style={{\n            padding: \"8px 14px\",\n            borderRadius: 6,\n            border: \"none\",\n            background: \"#2563eb\",\n            color: \"#fff\",\n            cursor: \"pointer\",\n          }}\n        >\n          Login\n        </button>\n\n        <button\n          onClick={handleClear}\n          style={{\n            padding: \"8px 14px\",\n            borderRadius: 6,\n            border: \"1px solid #ccc\",\n            background: \"#f5f5f5\",\n            cursor: \"pointer\",\n          }}\n        >\n          Clear\n        </button>\n      </div>\n\n      {/* Status Message */}\n      {message && (\n        <div\n          style={{\n            marginTop: 10,\n            color: isValid ? \"green\" : \"#d93025\",\n          }}\n        >\n          {message}\n        </div>\n      )}\n\n      {/* Decoded Token Info */}\n      {decoded && (\n        <div\n          style={{\n            marginTop: 14,\n            padding: 10,\n            background: \"#f9fafb\",\n            borderRadius: 6,\n            fontSize: 14,\n          }}\n        >\n          <b>Decoded Token</b>\n          <div>User: <b>{decoded.sub}</b></div>\n          <div>Role: <b>{decoded.role}</b></div>\n          {decoded.exp && (\n            <div>\n              Expires:{\" \"}\n              <b style={{ color: isExpired ? \"#d93025\" : \"green\" }}>\n                {new Date(decoded.exp * 1000).toLocaleString()}\n              </b>\n              {isExpired && \" ‚ö†\"}\n            </div>\n          )}\n        </div>\n      )}\n\n      <div style={{ marginTop: 10, fontSize: 12, color: \"#666\" }}>\n        Token is stored locally and never sent anywhere except secured API calls.\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}