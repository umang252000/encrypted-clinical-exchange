{"ast":null,"code":"import React,{useState,useEffect}from\"react\";// ----------------------------------\n// Helper: decode JWT payload (DEV)\n// ----------------------------------\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function parseJwtPayload(token){try{const base64Url=token.split(\".\")[1];if(!base64Url)return null;const base64=base64Url.replace(/-/g,\"+\").replace(/_/g,\"/\");const jsonPayload=decodeURIComponent(atob(base64).split(\"\").map(c=>\"%\"+(\"00\"+c.charCodeAt(0).toString(16)).slice(-2)).join(\"\"));return JSON.parse(jsonPayload);}catch(_unused){return null;}}export default function Login(_ref){let{onToken}=_ref;const[token,setToken]=useState(\"\");const[decoded,setDecoded]=useState(null);const[message,setMessage]=useState(\"\");// ----------------------------------\n// Load saved token on mount\n// ----------------------------------\nuseEffect(()=>{const saved=sessionStorage.getItem(\"jwt\");if(saved){setToken(saved);setDecoded(parseJwtPayload(saved));}},[]);// ----------------------------------\n// Decode JWT live when typing\n// ----------------------------------\nuseEffect(()=>{setDecoded(parseJwtPayload(token));},[token]);// ----------------------------------\n// Helpers\n// ----------------------------------\nconst isExpired=(decoded===null||decoded===void 0?void 0:decoded.exp)&&decoded.exp*1000<Date.now();const isValid=decoded&&decoded.sub&&decoded.role&&!isExpired;// ----------------------------------\n// Actions\n// ----------------------------------\nfunction handleSetToken(){if(!isValid){setMessage(\"âŒ Invalid or expired token\");onToken(\"\");return;}onToken(token);setMessage(\"âœ… Token applied successfully\");}function handleClear(){setToken(\"\");setDecoded(null);onToken(\"\");setMessage(\"ðŸ”„ Token cleared\");}// ----------------------------------\n// UI\n// ----------------------------------\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:14},children:[/*#__PURE__*/_jsx(\"input\",{style:{width:520},placeholder:\"Paste JWT token here (dev)\",value:token,onChange:e=>setToken(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{style:{marginLeft:8},onClick:handleSetToken,disabled:!token,children:\"Set Token\"}),/*#__PURE__*/_jsx(\"button\",{style:{marginLeft:8},onClick:handleClear,children:\"Clear\"}),message&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8,color:isValid?\"green\":\"#d93025\"},children:message}),decoded&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,padding:8,background:\"#f5f5f5\",borderRadius:6,width:520},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Decoded Token\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"User: \",/*#__PURE__*/_jsx(\"b\",{children:decoded.sub})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Role: \",/*#__PURE__*/_jsx(\"b\",{children:decoded.role})]}),decoded.exp&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Expires:\",\" \",/*#__PURE__*/_jsx(\"b\",{style:{color:isExpired?\"#d93025\":\"green\"},children:new Date(decoded.exp*1000).toLocaleString()}),isExpired&&\" âš \"]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","parseJwtPayload","token","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","_unused","Login","_ref","onToken","setToken","decoded","setDecoded","message","setMessage","saved","sessionStorage","getItem","isExpired","exp","Date","now","isValid","sub","role","handleSetToken","handleClear","style","marginBottom","children","width","placeholder","value","onChange","e","target","marginLeft","onClick","disabled","marginTop","color","padding","background","borderRadius","toLocaleString"],"sources":["/workspaces/encrypted-clinical-exchange/clinician-ui/src/Login.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\n\n// ----------------------------------\n// Helper: decode JWT payload (DEV)\n// ----------------------------------\nfunction parseJwtPayload(token) {\n  try {\n    const base64Url = token.split(\".\")[1];\n    if (!base64Url) return null;\n    const base64 = base64Url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const jsonPayload = decodeURIComponent(\n      atob(base64)\n        .split(\"\")\n        .map((c) => \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2))\n        .join(\"\")\n    );\n    return JSON.parse(jsonPayload);\n  } catch {\n    return null;\n  }\n}\n\nexport default function Login({ onToken }) {\n  const [token, setToken] = useState(\"\");\n  const [decoded, setDecoded] = useState(null);\n  const [message, setMessage] = useState(\"\");\n\n  // ----------------------------------\n  // Load saved token on mount\n  // ----------------------------------\n  useEffect(() => {\n    const saved = sessionStorage.getItem(\"jwt\");\n    if (saved) {\n      setToken(saved);\n      setDecoded(parseJwtPayload(saved));\n    }\n  }, []);\n\n  // ----------------------------------\n  // Decode JWT live when typing\n  // ----------------------------------\n  useEffect(() => {\n    setDecoded(parseJwtPayload(token));\n  }, [token]);\n\n  // ----------------------------------\n  // Helpers\n  // ----------------------------------\n  const isExpired =\n    decoded?.exp && decoded.exp * 1000 < Date.now();\n\n  const isValid =\n    decoded && decoded.sub && decoded.role && !isExpired;\n\n  // ----------------------------------\n  // Actions\n  // ----------------------------------\n  function handleSetToken() {\n    if (!isValid) {\n      setMessage(\"âŒ Invalid or expired token\");\n      onToken(\"\");\n      return;\n    }\n\n    onToken(token);\n    setMessage(\"âœ… Token applied successfully\");\n  }\n\n  function handleClear() {\n    setToken(\"\");\n    setDecoded(null);\n    onToken(\"\");\n    setMessage(\"ðŸ”„ Token cleared\");\n  }\n\n  // ----------------------------------\n  // UI\n  // ----------------------------------\n  return (\n    <div style={{ marginBottom: 14 }}>\n      <input\n        style={{ width: 520 }}\n        placeholder=\"Paste JWT token here (dev)\"\n        value={token}\n        onChange={(e) => setToken(e.target.value)}\n      />\n\n      <button\n        style={{ marginLeft: 8 }}\n        onClick={handleSetToken}\n        disabled={!token}\n      >\n        Set Token\n      </button>\n\n      <button style={{ marginLeft: 8 }} onClick={handleClear}>\n        Clear\n      </button>\n\n      {/* Status Message */}\n      {message && (\n        <div style={{ marginTop: 8, color: isValid ? \"green\" : \"#d93025\" }}>\n          {message}\n        </div>\n      )}\n\n      {/* Decoded Token Info */}\n      {decoded && (\n        <div\n          style={{\n            marginTop: 10,\n            padding: 8,\n            background: \"#f5f5f5\",\n            borderRadius: 6,\n            width: 520,\n          }}\n        >\n          <b>Decoded Token</b>\n          <div>User: <b>{decoded.sub}</b></div>\n          <div>Role: <b>{decoded.role}</b></div>\n          {decoded.exp && (\n            <div>\n              Expires:{\" \"}\n              <b style={{ color: isExpired ? \"#d93025\" : \"green\" }}>\n                {new Date(decoded.exp * 1000).toLocaleString()}\n              </b>\n              {isExpired && \" âš \"}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}